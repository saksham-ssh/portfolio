@echo off
setlocal EnableDelayedExpansion

set "input=input.txt"
set "output=output.txt"

> "%output%" (
  for /f "usebackq delims=" %%A in ("%input%") do (
    set "line=%%A"

    REM Remove everything after last /
    for %%B in ("!line!") do (
      set "dir=%%~dpB"
    )

    REM Remove trailing slash
    if "!dir:~-1!"=="/" set "dir=!dir:~0,-1!"

    REM Write XML mapping
    echo ^<DIR VCSPATH='!dir!' MAPPEDPATH='!dir!' /^>
  )
)

echo Done!
pause
